[package]
edition = "2021"
name = "affine_native"
version = "0.0.0"

[lib]
crate-type = ["cdylib"]

[dependencies]
affine_schema = { path = "./schema" }
anyhow = "1"
chrono = "0.4"
napi = { version = "2", default-features = false, features = [
  "napi5",
  "tokio_rt",
  "serde-json",
  "error_anyhow",
  "chrono_date",
] }
napi-derive = "2"
notify = { version = "6", features = ["serde"] }
once_cell = "1"
parking_lot = "0.12"
serde = "1"
serde_json = "1"
tokio = { version = "1", features = ["full"] }
uuid = { version = "1", default-features = false, features = [
  "serde",
  "v4",
  "fast-rng",
] }

[target.'cfg(all(target_os = "windows", target_arch = "aarch64"))'.dependencies]
sqlx = { version = "0.7.0", default-features = false, features = [
  "sqlite",
  "runtime-tokio",
  "chrono",
  "macros",
  "tls-native-tls",
] }

[target.'cfg(not(all(target_os = "windows", target_arch = "aarch64")))'.dependencies]
sqlx = { version = "0.7.0", default-features = false, features = [
  "sqlite",
  "runtime-tokio",
  "chrono",
  "macros",
  "tls-rustls",
] }

[build-dependencies]
affine_schema = { path = "./schema" }
dotenv = "0.15"
napi-build = "2"
sqlx = { version = "0.7.0-alpha.3", default-features = false, features = [
  "sqlite",
  "runtime-tokio",
  "tls-rustls",
  "chrono",
  "macros",
  "migrate",
  "json",
] }
tokio = { version = "1", features = ["full"] }
